{% extends "common.html" %}
{% block content %}
<script src="/static/geoui/splitter.js"></script>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    STYLE
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<style>
.leftpane {
    width: 250px;
    height: 95vh;
    background: #fcfcfc;
}
.centerpane {
    width: 250px;
    height: 95vh;
    background: #fcfcfc;
}
/* .rightpane {
    width: 250px;
    height: 95vh;
    background: #fcfcfc;
} */
video {
  /* override other styles to make responsive */
  width: 100%    !important;
  height: auto   !important;
}
#sort td{
    min-height: 80px;
    border-bottom: 1px solid #e0e0e0;
    border-top:    1px solid #e0e0e0;
    padding: 3px;
    
}
button{
  cursor: pointer;
  outline: 0;
  color: #AAA;

}

.btn:focus {
  outline: none;
}

.green{
  color: green;
}

.red{
  color: red;
}
</style>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    HTML
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<div id="workspace">
<div id="leftPane" class="leftpane scroller ">
    <table id="sort" style="width: 100%;">
    <tbody>
         <a id='tweets' class="twitter-timeline" width="100%" height="100%" href="https://twitter.com/science?ref_src=twsrc%5Etfw">Tweets</a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <H5 id='related_videos' style="padding:10px;"> Related Videos </H5>
        <tr><td><div class="bt"> Name </div>Apple</td><td></td><td></td></tr>
    </tbody>
    </table>
</div>

<div id="centerPane" class="centerpane scroller ">
    <div id="centerPane" style="padding: 10px; margin: 10px;">
        <div id="video" style="height:50vh;" >
    <iframe id="fvideo" width="100%" height="100%" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        </div>
        <br>
        <div id="title" > 
            <H5 style="padding:0px;"> Matrix Multiplication</H5>
        </div>

        <script src="https://use.fontawesome.com/fe459689b4.js"></script>
        <button class="btn" id="green"><i class="fa fa-thumbs-up fa-lg" aria-hidden="true"></i></button>
        <button class="btn" id="red"><i class="fa fa-thumbs-down fa-lg" aria-hidden="true"></i></button>
        <script>
        var btn1 = document.querySelector('#green');
        var btn2 = document.querySelector('#red');
        btn1.addEventListener('click', function() {
            if (btn2.classList.contains('red')) {
              btn2.classList.remove('red');
            } 
          this.classList.toggle('green');
        });
        btn2.addEventListener('click', function() {
            if (btn1.classList.contains('green')) {
              btn1.classList.remove('green');
            } 
          this.classList.toggle('red');
        });
        </script>

        <html lang="en">
        <head>
            <link rel="stylesheet" href="myCode.css">
        </head>
        <body>
        <div class="container" style="padding: 10px; margin: 10px;">
            <label for="comment" name="comment">ADD YOUR COMMENT BELOW-</label>
            <textarea id="comment"></textarea>
            <button id="addComments">Add</button>
            <div id="allComments"></div>
        </div>
        <script src="index.js"></script>
        </body>
        </html>

        </div>
    </div>
</div>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    SCRIPTS
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
<script> 
    
// Comments ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    
    
window.onload = function setTemplate() {
    document.getElementById('allComments').innerHTML = localStorage.getItem('template');
};

const commentContainer = document.getElementById('allComments');
document.getElementById('addComments').addEventListener('click', function (ev) {
   addComment(ev);
});

function addComment(ev) {
    let commentText, wrapDiv;
    const textBox = document.createElement('div');
    const replyButton = document.createElement('button');
    replyButton.className = 'reply';
    replyButton.innerHTML = 'Reply';
    const likeButton = document.createElement('button');
    likeButton.innerHTML = 'Like';
    likeButton.className = 'likeComment';
    const deleteButton = document.createElement('button');
    deleteButton.innerHTML = 'Delete';
    deleteButton.className = 'deleteComment';
    if(hasClass(ev.target.parentElement, 'container')) {
        const wrapDiv = document.createElement('div');
        wrapDiv.className = 'wrapper';
        wrapDiv.style.marginLeft = 0;
        commentText = document.getElementById('comment').value;
        document.getElementById('comment').value = '';
        textBox.innerHTML = commentText;
        textBox.style.backgroundColor = "cornflowerblue";
        wrapDiv.append(textBox, replyButton, likeButton, deleteButton);
        commentContainer.appendChild(wrapDiv);
    } else {
        wrapDiv = ev.target.parentElement;
        commentText = ev.target.parentElement.firstElementChild.value;
        textBox.innerHTML = commentText;
        textBox.style.backgroundColor = "paleturquoise";
        wrapDiv.innerHTML = '';
        wrapDiv.append(textBox, replyButton, likeButton, deleteButton);
    }
    setOnLocalStorage();
}

function setOnLocalStorage () {
    localStorage.setItem('template', document.getElementById('allComments').innerHTML);
}
function hasClass(elem, className) {
    return elem.className.split(' ').indexOf(className) > -1;
}
document.getElementById('allComments').addEventListener('click', function (e) {
    if (hasClass(e.target, 'reply')) {
        const parentDiv = e.target.parentElement;
        const wrapDiv = document.createElement('div');
        wrapDiv.style.marginLeft = (Number.parseInt(parentDiv.style.marginLeft) + 15).toString() + 'px';
        wrapDiv.className = 'wrapper';
        const textArea = document.createElement('textarea');
        textArea.style.marginRight = '20px';
        const addButton = document.createElement('button');
        addButton.className = 'addReply';
        addButton.innerHTML = 'Add';
        const cancelButton = document.createElement('button');
        cancelButton.innerHTML = 'Cancel';
        cancelButton.className='cancelReply';
        wrapDiv.append(textArea, addButton, cancelButton);
        parentDiv.appendChild(wrapDiv);

    } else if(hasClass(e.target, 'addReply')) {
        addComment(e);
    } else if(hasClass(e.target, 'likeComment')) {
         const likeBtnValue = e.target.innerHTML;
         e.target.innerHTML = likeBtnValue !== 'Like' ? Number.parseInt(likeBtnValue) + 1 : 1;
        setOnLocalStorage();
    } else if(hasClass(e.target, 'cancelReply')) {
        e.target.parentElement.innerHTML = '';
        setOnLocalStorage();
    } else if(hasClass(e.target, 'deleteComment')) {
        e.target.parentElement.remove();
    }
});     
    
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~   

var fixHelperModified = function(e, tr) {
    var $originals = tr.children();
    var $helper = tr.clone();
    $helper.children().each(function(index) {
        $(this).width($originals.eq(index).width())
    });
    return $helper;
},
updateIndex = function(e, ui) {
    $('td.index', ui.item.parent()).each(function (i) {
        $(this).html(i + 1);
    });
};

$("#sort tbody").sortable({
    helper: fixHelperModified,
    stop: updateIndex
}).disableSelection();
/* -------------------------------------------------------------------------
This expects the return to get in this order
symbol,name,open,high,low,price,vol,percent_change,trend
* */
function sidebarCB(responseTxt, statusTxt, xhr){
    if (JS_error(responseTxt, statusTxt, xhr, true) ) {
        return;
    }
    var ret1 = JSON.parse(responseTxt);
    var ret  = ret1.values;
    play(ret[0][0], ret[0][1], ret[0][3])
    
    tbody= ''
    for (var i=0; i < ret.length; i++ ) {
        var r   = ret[i]
        var tr = `<tr onclick="play('${r[0]}', '${r[1]}', '${r[3]}')" >
<td>&nbsp</td>
<td>${r[1]}</td>
<td><img src='${r[2]}'> </td> 
</tr>`
        tbody += tr
    }
    $('#sort tbody').html(tbody);
}
function sidebar(topic){
    topic = topic || ""
    document.getElementById('tweets').href = 'https://twitter.com/'+ topic +'?ref_src=twsrc%5Etfw'
    const URL1  = '/Video_Player/getmenu/?q='+topic
    $.get(URL1, sidebarCB)
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
function play(id, name, url){
    document.getElementById('fvideo').src = url;
    let title = document.getElementById('title');
    title.innerHTML = `<H5 style="padding:0px;"> ${name} </H5>`;
}
// ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

$(function () {
    $("#workspace").splitter({
        orientation: "horizontal",
        limit: 50,
        barwidth: 2,
    });
});
$(document).ready(function() {
    $(window).resize()
    var urlp = new URL(window.location.href)
    sidebar(urlp.searchParams.get('q'));
})
    

 
</script>
<br/>




<!-- {% include "footer.html" %} -->
{% endblock %}
